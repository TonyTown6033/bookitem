# ğŸ–±ï¸ ç‚¹å‡»æ¨¡å¼ä¼˜åŒ–è¯´æ˜

## ğŸ“‹ ä¼˜åŒ–èƒŒæ™¯

åŸæœ‰çš„æ—¶é—´é€‰æ‹©é‡‡ç”¨**æ‹–æ‹½æ¨¡å¼**ï¼ˆæŒ‰ä¸‹é¼ æ ‡å¹¶æ‹–åŠ¨ï¼‰ï¼Œè¿™åœ¨PCç«¯ä½“éªŒè‰¯å¥½ï¼Œä½†åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨ä¸ä¾¿ã€‚ç”¨æˆ·åé¦ˆéœ€è¦æ›´å‹å¥½çš„äº¤äº’æ–¹å¼ã€‚

## âœ¨ æ–°çš„äº¤äº’æ–¹å¼

### ç‚¹å‡»æ¨¡å¼ (Click Mode)

æ”¹ä¸º**ä¸¤æ¬¡ç‚¹å‡»**ç¡®å®šæ—¶é—´åŒºé—´çš„æ–¹å¼ï¼š

1. **ç¬¬ä¸€æ¬¡ç‚¹å‡»**ï¼šç¡®å®šèµ·ç‚¹
   - åœ¨æ—¶é—´è½´ä¸Šç‚¹å‡»ä»»æ„ä½ç½®
   - æ˜¾ç¤ºä¸€ä¸ªè„‰åŠ¨çš„æ ‡è®°ç‚¹
   - æç¤ºç”¨æˆ·"è¯·ç‚¹å‡»ç¬¬äºŒä¸ªä½ç½®ç¡®å®šæ—¶é—´åŒºé—´"

2. **é¼ æ ‡ç§»åŠ¨é¢„è§ˆ**ï¼šå®æ—¶æ˜¾ç¤ºåŒºé—´
   - ç¬¬ä¸€æ¬¡ç‚¹å‡»åç§»åŠ¨é¼ æ ‡
   - è™šçº¿æ¡†å®æ—¶æ˜¾ç¤ºé¢„è§ˆçš„æ—¶é—´åŒºé—´
   - æ˜¾ç¤ºèµ·æ­¢æ—¶é—´å’Œæ—¶é•¿

3. **ç¬¬äºŒæ¬¡ç‚¹å‡»**ï¼šç¡®å®šç»ˆç‚¹
   - å†æ¬¡ç‚¹å‡»æ—¶é—´è½´
   - è‡ªåŠ¨è®¡ç®—èµ·æ­¢æ—¶é—´ï¼ˆç¡®ä¿èµ·ç‚¹åœ¨å‰ï¼‰
   - éªŒè¯æ—¶é—´åŒºé—´æœ‰æ•ˆæ€§
   - å®Œæˆé€‰æ‹©

## ğŸ¯ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### PCç«¯
- âœ… æ›´ç²¾ç¡®çš„æ—¶é—´é€‰æ‹©
- âœ… å¯ä»¥ä»å®¹æ€è€ƒé€‰æ‹©èŒƒå›´
- âœ… å®æ—¶é¢„è§ˆæ•ˆæœ
- âœ… æ“ä½œæ›´æ¸…æ™°æ˜ç¡®

### ç§»åŠ¨ç«¯
- âœ… **æ— éœ€æ‹–æ‹½**ï¼Œé¿å…æ‰‹æŒ‡æ»‘åŠ¨ä¸ç¨³
- âœ… ä¸¤æ¬¡è½»è§¦å³å¯å®Œæˆé€‰æ‹©
- âœ… è§¦æ‘¸æ›´ç²¾å‡†
- âœ… æ“ä½œåé¦ˆæ›´æ˜æ˜¾

## ğŸ¨ è§†è§‰åé¦ˆ

### 1. ç¬¬ä¸€æ¬¡ç‚¹å‡»æ ‡è®°ç‚¹

**æ ·å¼ç‰¹å¾**
- ç´«è‰²æ¸å˜åœ†ç‚¹ï¼ˆ20pxï¼‰
- è„‰åŠ¨åŠ¨ç”»æ•ˆæœ
- åœ†å½¢æ‰©æ•£æ³¢çº¹
- é¡¶éƒ¨æ˜¾ç¤ºæ—¶é—´æ ‡ç­¾

**åŠ¨ç”»æ•ˆæœ**
```css
@keyframes markerPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

@keyframes dotPulse {
  0%, 100% { 
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.3),
                0 0 0 8px rgba(102, 126, 234, 0.15);
  }
  50% { 
    box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.4),
                0 0 0 12px rgba(102, 126, 234, 0.2);
  }
}
```

### 2. é¢„è§ˆåŒºé—´

**æœ‰æ•ˆåŒºé—´**
- è™šçº¿è¾¹æ¡†ï¼ˆç´«è‰²ï¼‰
- åŠé€æ˜ç´«è‰²æ¸å˜èƒŒæ™¯
- é—ªçƒåŠ¨ç”»ï¼ˆopacity: 0.7 â†” 1ï¼‰
- æ˜¾ç¤ºæ—¶é—´å’Œæ—¶é•¿

**å†²çªåŒºé—´**
- è™šçº¿è¾¹æ¡†ï¼ˆçº¢è‰²ï¼‰
- åŠé€æ˜çº¢è‰²æ¸å˜èƒŒæ™¯
- æç¤ºå†²çªè­¦å‘Š

**æ ·å¼ä»£ç **
```css
.preview-slot {
  border: 2px dashed #667eea;
  background: linear-gradient(135deg, 
    rgba(102, 126, 234, 0.15) 0%, 
    rgba(118, 75, 162, 0.15) 100%);
  animation: previewBlink 1s ease-in-out infinite;
}

.preview-slot.invalid {
  border-color: #f56565;
  background: linear-gradient(135deg, 
    rgba(245, 101, 101, 0.15) 0%, 
    rgba(229, 62, 62, 0.15) 100%);
}
```

### 3. æœ€ç»ˆé€‰æ‹©åŒºé—´

**ç¡®è®¤åçš„æ ·å¼**
- å®çº¿è¾¹æ¡†ï¼ˆè“ç»¿è‰²ï¼‰
- é²œè‰³çš„æ¸å˜èƒŒæ™¯
- æ—¥å†å›¾æ ‡ + æ—¶é—´ä¿¡æ¯
- è„‰åŠ¨å‘å…‰æ•ˆæœ

## ğŸ”§ æŠ€æœ¯å®ç°

### çŠ¶æ€ç®¡ç†

```javascript
const firstClickPoint = ref(null)   // ç¬¬ä¸€æ¬¡ç‚¹å‡»çš„ç‚¹
const previewEnd = ref(null)        // é¼ æ ‡ç§»åŠ¨é¢„è§ˆçš„ç»ˆç‚¹
const selectionStart = ref(null)    // æœ€ç»ˆé€‰æ‹©çš„èµ·ç‚¹
const selectionEnd = ref(null)      // æœ€ç»ˆé€‰æ‹©çš„ç»ˆç‚¹
const selectedSlot = ref(null)      // ç¡®è®¤çš„æ—¶é—´æ§½
```

### æ ¸å¿ƒå‡½æ•°

#### 1. handleTimelineClick - å¤„ç†ç‚¹å‡»

```javascript
const handleTimelineClick = (e) => {
  const time = getTimeFromPosition(x, width)
  
  if (!firstClickPoint.value) {
    // ç¬¬ä¸€æ¬¡ç‚¹å‡»
    firstClickPoint.value = time
    selectionStart.value = time
    selectionEnd.value = time
    ElMessage.info('è¯·ç‚¹å‡»ç¬¬äºŒä¸ªä½ç½®ç¡®å®šæ—¶é—´åŒºé—´')
  } else {
    // ç¬¬äºŒæ¬¡ç‚¹å‡»
    let start = firstClickPoint.value
    let end = time
    
    // ç¡®ä¿èµ·ç‚¹åœ¨å‰
    if (start > end) [start, end] = [end, start]
    
    // éªŒè¯æœ€å°æ—¶é•¿ï¼ˆ30åˆ†é’Ÿï¼‰
    const minDuration = 30 * 60 * 1000
    if (end - start < minDuration) {
      ElMessage.warning('é¢„çº¦æ—¶é•¿è‡³å°‘ä¸º30åˆ†é’Ÿ')
      clearSelection()
      return
    }
    
    // éªŒè¯æœ‰æ•ˆæ€§
    if (isValidSelection.value) {
      selectedSlot.value = { start, end }
      // æ¸…é™¤ç¬¬ä¸€æ¬¡ç‚¹å‡»çŠ¶æ€
      firstClickPoint.value = null
      previewEnd.value = null
    }
  }
}
```

#### 2. handleTimelineMove - å¤„ç†ç§»åŠ¨é¢„è§ˆ

```javascript
const handleTimelineMove = (e) => {
  if (!firstClickPoint.value) return
  
  const time = getTimeFromPosition(x, width)
  previewEnd.value = time
  
  // æ›´æ–°é¢„è§ˆåŒºé—´
  let start = firstClickPoint.value
  let end = time
  if (start > end) [start, end] = [end, start]
  
  selectionStart.value = start
  selectionEnd.value = end
}
```

#### 3. cancelSelection - å–æ¶ˆé€‰æ‹©

```javascript
const cancelSelection = () => {
  firstClickPoint.value = null
  previewEnd.value = null
  selecting.value = false
  selectionStart.value = null
  selectionEnd.value = null
  selectedSlot.value = null
}
```

## ğŸ“ äº‹ä»¶ç»‘å®š

### æ—§çš„æ‹–æ‹½æ¨¡å¼

```vue
<div 
  class="timeline-track"
  @mousedown="startSelection"
  @mousemove="updateSelection"
  @mouseup="endSelection"
  @mouseleave="cancelSelection"
>
```

### æ–°çš„ç‚¹å‡»æ¨¡å¼

```vue
<div 
  class="timeline-track"
  @click="handleTimelineClick"
  @mousemove="handleTimelineMove"
  @mouseleave="previewEnd = null"
>
```

**ä¸»è¦å˜åŒ–**
- âŒ ç§»é™¤ï¼š`@mousedown`, `@mouseup`
- âœ… æ·»åŠ ï¼š`@click`
- âœ… ä¿ç•™ï¼š`@mousemove`ï¼ˆç”¨äºé¢„è§ˆï¼‰
- âœ… ç®€åŒ–ï¼š`@mouseleave`ï¼ˆä»…æ¸…é™¤é¢„è§ˆï¼‰

## ğŸ¯ ä½¿ç”¨æµç¨‹

### å®Œæ•´æ“ä½œæµç¨‹

```
1. ç”¨æˆ·é€‰æ‹©æ—¥æœŸ
   â†“
2. æŸ¥çœ‹æ—¶é—´è½´
   â”œâ”€ ç™½è‰²åŒºåŸŸï¼šå¯é¢„çº¦
   â”œâ”€ ç°è‰²åŒºåŸŸï¼šå·²è¿‡æœŸ
   â””â”€ ç´«è‰²åŒºåŸŸï¼šå·²é¢„çº¦
   â†“
3. ç¬¬ä¸€æ¬¡ç‚¹å‡»ï¼ˆèµ·ç‚¹ï¼‰
   â”œâ”€ æ˜¾ç¤ºè„‰åŠ¨æ ‡è®°ç‚¹
   â”œâ”€ æç¤ºæ¶ˆæ¯ï¼š"è¯·ç‚¹å‡»ç¬¬äºŒä¸ªä½ç½®..."
   â””â”€ é¼ æ ‡ç§»åŠ¨æ˜¾ç¤ºé¢„è§ˆåŒºé—´
   â†“
4. ç¬¬äºŒæ¬¡ç‚¹å‡»ï¼ˆç»ˆç‚¹ï¼‰
   â”œâ”€ è‡ªåŠ¨è®¡ç®—èµ·æ­¢æ—¶é—´
   â”œâ”€ éªŒè¯æœ€å°æ—¶é•¿ï¼ˆ30åˆ†é’Ÿï¼‰
   â”œâ”€ æ£€æŸ¥æ—¶é—´å†²çª
   â””â”€ æ˜¾ç¤ºæœ€ç»ˆé€‰æ‹©
   â†“
5. å¡«å†™ä¼šè®®ä¿¡æ¯
   â†“
6. æäº¤é¢„çº¦
```

## ğŸ’¡ ç”¨æˆ·å¼•å¯¼

### ç•Œé¢æç¤º

åœ¨æ—¥æœŸé€‰æ‹©å™¨æ—è¾¹æ·»åŠ äº†ä½¿ç”¨è¯´æ˜ï¼š

```vue
<div class="usage-hint">
  <el-icon><InfoFilled /></el-icon>
  <span>ç‚¹å‡»æ—¶é—´è½´ä¸¤æ¬¡é€‰æ‹©æ—¶é—´åŒºé—´ï¼ˆç¬¬ä¸€æ¬¡ç¡®å®šèµ·ç‚¹ï¼Œç¬¬äºŒæ¬¡ç¡®å®šç»ˆç‚¹ï¼‰</span>
</div>
```

**æ ·å¼**
- æ·¡è“è‰²æ¸å˜èƒŒæ™¯
- è“è‰²è¾¹æ¡†
- ä¿¡æ¯å›¾æ ‡
- æ¸…æ™°çš„æ–‡å­—è¯´æ˜

### æ“ä½œæç¤ºæ¶ˆæ¯

**ç¬¬ä¸€æ¬¡ç‚¹å‡»å**
```javascript
ElMessage.info('è¯·ç‚¹å‡»ç¬¬äºŒä¸ªä½ç½®ç¡®å®šæ—¶é—´åŒºé—´', { duration: 2000 })
```

**æ—¶é•¿ä¸è¶³**
```javascript
ElMessage.warning('é¢„çº¦æ—¶é•¿è‡³å°‘ä¸º30åˆ†é’Ÿ')
```

**æ—¶é—´å†²çª**
```javascript
ElMessage.warning('æ‰€é€‰æ—¶é—´æ®µæœ‰å†²çªï¼Œè¯·é‡æ–°é€‰æ‹©')
```

## ğŸ¨ åŠ¨ç”»æ•ˆæœæ±‡æ€»

### 1. æ ‡è®°ç‚¹è„‰åŠ¨

- **åŠ¨ç”»æ—¶é•¿**ï¼š1.5ç§’
- **å¾ªç¯**ï¼šæ— é™å¾ªç¯
- **æ•ˆæœ**ï¼šç¼©æ”¾ + æ³¢çº¹æ‰©æ•£

### 2. é¢„è§ˆåŒºé—´é—ªçƒ

- **åŠ¨ç”»æ—¶é•¿**ï¼š1ç§’
- **å¾ªç¯**ï¼šæ— é™å¾ªç¯
- **æ•ˆæœ**ï¼šé€æ˜åº¦å˜åŒ–ï¼ˆ0.7 â†” 1ï¼‰

### 3. æœ€ç»ˆé€‰æ‹©å‘å…‰

- **åŠ¨ç”»æ—¶é•¿**ï¼š2ç§’
- **å¾ªç¯**ï¼šæ— é™å¾ªç¯
- **æ•ˆæœ**ï¼šé˜´å½±å¼ºåº¦å˜åŒ–

## ğŸ“Š ä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | æ‹–æ‹½æ¨¡å¼ | ç‚¹å‡»æ¨¡å¼ |
|------|---------|---------|
| **PCç«¯æ“ä½œ** | âœ… æµç•… | âœ… æ›´ç²¾ç¡® |
| **ç§»åŠ¨ç«¯æ“ä½œ** | âŒ å›°éš¾ | âœ… ç®€å• |
| **ç²¾ç¡®åº¦** | ä¸­ç­‰ | âœ… é«˜ |
| **å®æ—¶åé¦ˆ** | æ‹–æ‹½ä¸­é¢„è§ˆ | âœ… ç§»åŠ¨é¢„è§ˆ |
| **æ“ä½œæç¤º** | æ—  | âœ… å¤šé‡æç¤º |
| **é”™è¯¯ç‡** | ä¸­ç­‰ | âœ… ä½ |
| **å­¦ä¹ æˆæœ¬** | ä½ | âœ… æ›´ä½ |
| **å¯è®¿é—®æ€§** | ä¸­ç­‰ | âœ… æ›´å¥½ |

## ğŸ” ç»†èŠ‚ä¼˜åŒ–

### 1. è‡ªåŠ¨æ’åº

```javascript
// æ— è®ºç”¨æˆ·å…ˆç‚¹å“ªé‡Œï¼Œåç‚¹å“ªé‡Œ
// ç³»ç»Ÿè‡ªåŠ¨ç¡®ä¿èµ·ç‚¹åœ¨å‰ï¼Œç»ˆç‚¹åœ¨å
if (start > end) {
  [start, end] = [end, start]
}
```

### 2. æ—¶é—´å¸é™„

æ‰€æœ‰ç‚¹å‡»è‡ªåŠ¨å¸é™„åˆ°æœ€è¿‘çš„åŠå°æ—¶åˆ»åº¦ï¼š

```javascript
const getTimeFromPosition = (x, width) => {
  const ratio = Math.max(0, Math.min(1, x / width))
  const minutes = Math.round(ratio * 24 * 60 / 30) * 30 // 30åˆ†é’Ÿå•ä½
  date.setMinutes(minutes)
  return date
}
```

### 3. æœ€å°æ—¶é•¿é™åˆ¶

```javascript
const minDuration = 30 * 60 * 1000 // 30åˆ†é’Ÿï¼ˆæ¯«ç§’ï¼‰
if (end - start < minDuration) {
  ElMessage.warning('é¢„çº¦æ—¶é•¿è‡³å°‘ä¸º30åˆ†é’Ÿ')
  clearSelection()
  return
}
```

### 4. å†²çªæ£€æµ‹

å®æ—¶æ£€æŸ¥ä¸å·²æœ‰é¢„çº¦å’Œè¿‡æœŸæ—¶é—´çš„å†²çªï¼š

```javascript
const isValidSelection = computed(() => {
  // æ£€æŸ¥æ˜¯å¦åœ¨è¿‡å»
  if (selectionStart.value < now) return false
  
  // æ£€æŸ¥æ˜¯å¦ä¸è¿‡å»æ—¶é—´æ®µé‡å 
  if (pastTimeSlot.value) { /* ... */ }
  
  // æ£€æŸ¥æ˜¯å¦ä¸å·²æœ‰é¢„çº¦å†²çª
  return !bookedSlots.value.some(/* ... */)
})
```

## ğŸš€ æœªæ¥æ”¹è¿›

### å¯èƒ½çš„å¢å¼ºåŠŸèƒ½

1. **è§¦æ‘¸äº‹ä»¶ä¼˜åŒ–**
   - æ·»åŠ  `@touchstart`ã€`@touchend` æ”¯æŒ
   - ä¼˜åŒ–ç§»åŠ¨ç«¯è§¦æ‘¸åé¦ˆ

2. **é”®ç›˜æ”¯æŒ**
   - æ”¯æŒæ–¹å‘é”®è°ƒæ•´æ—¶é—´
   - ESC é”®å–æ¶ˆé€‰æ‹©
   - Enter é”®ç¡®è®¤

3. **æ‰‹åŠ¿æ”¯æŒ**
   - åŒæŒ‡ç¼©æ”¾è°ƒæ•´æ—¶é•¿
   - å·¦å³æ»‘åŠ¨åˆ‡æ¢æ—¥æœŸ

4. **æ™ºèƒ½å»ºè®®**
   - æ ¹æ®ä¼šè®®ä¹ æƒ¯æ¨èæ—¶é•¿
   - è‡ªåŠ¨é¿å¼€åˆé¤ã€ä¼‘æ¯æ—¶é—´

5. **å¿«æ·é€‰æ‹©**
   - é¢„è®¾æ—¶é•¿æŒ‰é’®ï¼ˆ30åˆ†é’Ÿã€1å°æ—¶ã€2å°æ—¶ï¼‰
   - å¸¸ç”¨æ—¶æ®µå¿«æ·é€‰æ‹©

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

è™½ç„¶å½“å‰å®ç°å·²ç»å¯¹ç§»åŠ¨ç«¯å‹å¥½ï¼Œæœªæ¥å¯ä»¥è€ƒè™‘ï¼š

### å“åº”å¼ä¼˜åŒ–

```css
@media (max-width: 768px) {
  .timeline-track {
    height: 100px; /* å¢åŠ è§¦æ‘¸é¢ç§¯ */
  }
  
  .marker-dot {
    width: 30px;   /* å¢å¤§æ ‡è®°ç‚¹ */
    height: 30px;
  }
  
  .usage-hint {
    font-size: 12px;
    padding: 6px 12px;
  }
}
```

### è§¦æ‘¸ä¼˜åŒ–

```javascript
// æ·»åŠ è§¦æ‘¸äº‹ä»¶å¤„ç†
const handleTouch = (e) => {
  e.preventDefault()
  const touch = e.touches[0]
  // æ¨¡æ‹Ÿç‚¹å‡»äº‹ä»¶
  handleTimelineClick({ 
    clientX: touch.clientX,
    currentTarget: e.currentTarget 
  })
}
```

## ğŸ“… æ›´æ–°æ—¥æœŸ

2025-11-19

## ğŸ‰ æ€»ç»“

é€šè¿‡å°†æ‹–æ‹½æ¨¡å¼æ”¹ä¸ºç‚¹å‡»æ¨¡å¼ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

âœ… **æ›´å¥½çš„ç§»åŠ¨ç«¯ä½“éªŒ** - æ— éœ€æ‹–æ‹½ï¼Œä¸¤æ¬¡è½»è§¦å³å¯  
âœ… **æ›´é«˜çš„æ“ä½œç²¾åº¦** - ç‚¹å‡»æ¯”æ‹–æ‹½æ›´ç²¾ç¡®  
âœ… **æ›´æ¸…æ™°çš„åé¦ˆ** - æ ‡è®°ç‚¹ã€é¢„è§ˆåŒºé—´ã€åŠ¨ç”»æ•ˆæœ  
âœ… **æ›´å¥½çš„å¼•å¯¼** - å¤šé‡æç¤ºå’Œè¯´æ˜  
âœ… **æ›´ä½çš„é”™è¯¯ç‡** - è‡ªåŠ¨æ’åºã€å†²çªæ£€æµ‹  

è¿™æ¬¡ä¼˜åŒ–æ˜¾è‘—æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯ç”¨æˆ·ï¼ğŸ‰ğŸ“±

---

**ç°åœ¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½“éªŒå…¨æ–°çš„ç‚¹å‡»é€‰æ‹©æ¨¡å¼ï¼** ğŸ–±ï¸âœ¨

